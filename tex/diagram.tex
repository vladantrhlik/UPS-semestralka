\documentclass[11pt,a4paper]{article}

\usepackage{titling}
\usepackage{float}
\usepackage[parfill]{parskip}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
\usepackage[T1]{fontenc}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
% automata
\usepackage{tikz}
\usetikzlibrary{automata,positioning}

\author{Vladan Trhlík}
\title{UPS}

\begin{document}

\maketitle

\section{Protokol}

\subsection{Přihlášení}
\begin{itemize}
	\item \textbf{Client:} \texttt{LOGIN|<name>}
	\item \textbf{Server:} \texttt{OK/ERR<1/2>}
\end{itemize}

\subsection{Načtení všech lobby}
\begin{itemize}
	\item \textbf{Client:} \texttt{LOAD\_LOBBY}
	\item \textbf{Server:} \texttt{OK|<N>|<lobby1-name>|<lobby2-name>|...|<lobbyN-name>/ERR}
\end{itemize}

\subsection{Vytvoření lobby}
\begin{itemize}
	\item \textbf{Client:} \texttt{CREATE|<lobby-name>}
	\item \textbf{Server:} \texttt{OK/ERR<1/2>}
\end{itemize}

\subsection{Připojení do lobby}
\begin{itemize}
	\item \textbf{Client:} \texttt{JOIN|<lobby-name>}
	\item \textbf{Server:} \texttt{OK/ERR}
\end{itemize}

\subsection{Oponent se připojil}
\begin{itemize}
	\item \textbf{Server:} \texttt{OP\_JOIN|<op-name>}
	\item \textbf{Client:} \texttt{OK/ERR}
\end{itemize}

\subsection{Tah}
\begin{itemize}
	\item \textbf{Client:} \texttt{TURN|X|Y}
	\item \textbf{Server:} \texttt{OK/ERR<0/3>}
\end{itemize}

\subsection{Hráč je na tahu}
\begin{itemize}
	\item \textbf{Server:} \texttt{ON\_TURN}
	\item \textbf{Client:} \texttt{OK/ERR}
\end{itemize}

\subsection{Oponent je na tahu}
\begin{itemize}
	\item \textbf{Server:} \texttt{OP\_TURN}
	\item \textbf{Client:} \texttt{OK/ERR}

\end{itemize}

\subsection{Konec hry}
\begin{itemize}
	\item \textbf{Server:} \texttt{END|<WIN/LOSE>}
	\item \textbf{Client:} \texttt{OK/ERR}
\end{itemize}

\section{Errory}
\begin{itemize}
	\item \texttt{0} -- default
	\item \texttt{1} -- invalid
	\item \texttt{2} -- already exists
	\item \texttt{3} -- not on turn
\end{itemize}

\section{Diagram}
\begin{tikzpicture}[shorten >=0pt,node distance=4cm,on grid,auto] 

   \node[state,initial] (q_0)   {waiting}; 
   \node[state] (q_1) [right=of q_0] {$P_1$ on turn}; 
   \node[state] (q_2) [right=of q_1] {$P_2$ on turn}; 
   \node[state] (q_3) [below=of q_1] {$P_1$ wins}; 
   \node[state] (q_4) [below=of q_2] {$P_2$ wins}; 
   \node[state,accepting] (q_5) [below=of q_3] {end}; 
    \path[->] 
		(q_0) edge node {$P_2$ joined} (q_1)
		% todo wtf
		(q_1) edge [bend left] node {$P_1$ turn} (q_2)
			  edge [loop above] node {$P_1$ turn} ()
			  edge node {$P_1$ turn} (q_3)
		(q_2) edge [bend left] node {$P_2$ turn} (q_1)
			  edge [loop above] node {$P_2$ turn} ()
			  edge node {$P_2$ turn} (q_4)
		(q_3) edge node {end} (q_5)
		(q_4) edge node {end} (q_5)

     
	%(q_0) edge  node {0} (q_1)
    %      edge  node [swap] {1} (q_2)
    %(q_1) edge  node  {1} (q_3)
    %      edge [loop above] node {0} ()
    %(q_2) edge  node [swap] {0} (q_3) 
    %      edge [loop below] node {1} ();
\end{tikzpicture}

\end{document}
